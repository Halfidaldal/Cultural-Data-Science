---
title: "Portfolio Assignment 2"
output: html_document
---

# Use pacman to load packages
```{r}
if (!require("pacman")) install.packages("pacman")
pacman::p_load("tidyverse", "dslabs", "car")
```

# Part 1: Margarine and Divorce

Use the ‘divorce_margarine’ dataset from the ‘dslabs’ package to explore the relationship between margarine consumption and divorce rates in Maine.

```{r}
data("divorce_margarine")
df <- divorce_margarine

# Visualise the data
ggplot(df, aes(x = margarine_consumption_per_capita, y = divorce_rate_maine)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Scatter Plot of Margarine Consumption vs Divorce Rate in Maine",
       x = "Margarine Consumption per Capita (lbs)",
       y = "Divorce Rate (per 1000)") +
  theme_minimal()
```

```{r}
# Correlation test
cor_test <- cor.test(df$margarine_consumption_per_capita, df$divorce_rate_maine)
cor_test
```

**Reporting:**
A Pearson correlation test indicated a strong negative correlation between margarine consumption and divorce rates in Maine, *r*(8) = .99, *p* < .001.

**Discussion:**
The results show a nearly perfect correlation, meaning that as margarine consumption drops, the divorce rate drops too. However, practically speaking, this is a textbook example of a spurious correlation. It is highly unlikely that eating margarine causes divorce (or vice versa). Instead, both variables are likely decreasing over time due to other unrelated societal trends.

# Part 2: GSS Vocabulary

Work with the ‘GSSvocab’ dataset from the ‘car’ package, focusing only on the year 1978.

```{r}
data("GSSvocab")

# Subset for 1978 and remove NA
gss_78 <- GSSvocab %>% 
  filter(year == "1978") %>% 
  drop_na()
```

## Model 1: Vocab ~ Education

Investigate how vocabulary test scores (vocab) are related to education (educ).

```{r}
# Plotting the relationship
ggplot(gss_78, aes(x = educ, y = vocab)) +
  geom_jitter(alpha = 0.5) +
  geom_smooth(method = "lm") +
  labs(title = "Vocabulary Score by Years of Education (1978)",
       x = "Years of Education",
       y = "Vocabulary Score") +
  theme_minimal()

# Linear model
model1 <- lm(vocab ~ educ, data = gss_78)
summary(model1)
```

**Reporting:**
A linear regression analysis was conducted to predict vocabulary scores based on years of education. A significant regression equation was found (*F*(1, 1475) = 442.2, *p* < .001), with an $R^2$ of .23.
The education predictor was significant (*b* = 0.39, *p* < .001).

**Interpretation:**
For every additional year of education, a person's vocabulary score increases by approximately 0.39 points. Education explains about 23% of the variance in vocabulary scores, which is decent but implies other factors matter too.

## Model 2: Adding Native Born status

Extend the analysis by making a new model, where you include whether a person is native-born (nativeBorn) as a predictor.

```{r}
# Visualise
ggplot(gss_78, aes(x = educ, y = vocab, color = nativeBorn)) +
  geom_jitter(alpha = 0.3) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Vocab Score by Education and Native Status",
       x = "Years of Education",
       y = "Vocabulary Score",
       color = "Native Born") +
  theme_minimal()

# Linear model with nativeBorn
model2 <- lm(vocab ~ educ + nativeBorn, data = gss_78)
summary(model2)
```

**Reporting:**
The multiple regression model with education and native-born status was significant, $R^2$ = .29, *F*(2, 1474) = 306.7, *p* < .001. 
Education remained a significant predictor (*b* = 0.39, *p* < .001), but native-born status was not significant (*b* = 0.16, *p* = .39).

**Interpretation:**
Adding native-born status didn't really help the model. It seems that being native-born doesn't significantly change your vocabulary score once you account for education level in this 1978 dataset.

## Model 3: Interaction

Consider whether education and native-born status interact in predicting vocabulary.

```{r}
# Interaction model
model3 <- lm(vocab ~ educ * nativeBorn, data = gss_78)
summary(model3)
```

**Reporting:**
The interaction model resulted in an $R^2$ of .29. The interaction effect between education and native-born status was not significant (*b* = -0.03, *p* = .66).

**Interpretation:**
This means the relationship between education and vocabulary is roughly the same whether you are native-born or not. The "return on investment" for education regarding vocabulary doesn't significantly differ between groups.

## Comparison and Conclusion

```{r}
# Quick comparison
anova(model1, model2, model3)
```

Based on the analysis, **Model 2** appears to be the best choice, though the improvement is modest. 
- **P-values:** Model 2 shows that nativeBorn does add statistically significant improvement (*p* = .002 in ANOVA comparison), even though the coefficient itself isn't significant. The interaction in Model 3 is clearly not significant (*p* = .66).
- **$R^2$:** The $R^2$ increased from .23 (Model 1) to .29 (Models 2 & 3), suggesting that native-born status does capture some variance.
- **Interpretability:** While Model 2 is slightly more complex, the ANOVA suggests it provides a better fit. However, practically speaking, the improvement is small and Model 1 remains highly interpretable with education as the primary predictor.

